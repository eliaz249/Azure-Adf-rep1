{
	"name": "WranglingDataFlow1",
	"properties": {
		"type": "WranglingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "Cust",
					"script": "",
					"dataset": {
						"referenceName": "Cust",
						"type": "DatasetReference"
					}
				},
				{
					"name": "saleordHdr",
					"script": "",
					"dataset": {
						"referenceName": "saleordHdr",
						"type": "DatasetReference"
					}
				}
			],
			"sinks": [
				{
					"name": "Sink1",
					"dataset": {
						"referenceName": "Target_file",
						"type": "DatasetReference"
					},
					"script": "sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['SlaesFact.txt'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Sink1"
				}
			],
			"script": "section Section1;\r\nshared Cust = let\r\n  AdfDoc = Sql.Database(\"el109.database.windows.net\", \"el109\"),\r\n  InputTable = AdfDoc{[Schema = \"SalesLT\", Item = \"Customer\"]}[Data]\r\nin\r\n  InputTable;\r\nshared saleordHdr = let\r\n  AdfDoc = Sql.Database(\"el109.database.windows.net\", \"el109\"),\r\n  InputTable = AdfDoc{[Schema = \"SalesLT\", Item = \"SalesOrderHeader\"]}[Data]\r\nin\r\n  InputTable;\r\nshared UserQuery = let\r\n  Source = Cust,\r\n  #\"Merged queries\" = Table.NestedJoin(Source, {\"CustomerID\"}, saleordHdr, {\"CustomerID\"}, \"saleordHdr\", JoinKind.Inner),\r\n  #\"Expanded SalesLT.CustomerAddress\" = Table.ExpandTableColumn(#\"Merged queries\", \"SalesLT.CustomerAddress\", {\"CustomerID\", \"AddressID\", \"AddressType\", \"rowguid\", \"ModifiedDate\", \"SalesLT.Address\", \"SalesLT.Customer\"}, {\"SalesLT.CustomerAddress.CustomerID\", \"SalesLT.CustomerAddress.AddressID\", \"SalesLT.CustomerAddress.AddressType\", \"SalesLT.CustomerAddress.rowguid\", \"SalesLT.CustomerAddress.ModifiedDate\", \"SalesLT.CustomerAddress.SalesLT.Address\", \"SalesLT.CustomerAddress.SalesLT.Customer\"}),\r\n  #\"Expanded SalesLT.CustomerAddress.SalesLT.Customer\" = Table.ExpandRecordColumn(#\"Expanded SalesLT.CustomerAddress\", \"SalesLT.CustomerAddress.SalesLT.Customer\", {\"CustomerID\", \"NameStyle\", \"Title\", \"FirstName\", \"MiddleName\", \"LastName\", \"Suffix\", \"CompanyName\", \"SalesPerson\", \"EmailAddress\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"rowguid\", \"ModifiedDate\", \"SalesLT.CustomerAddress\", \"SalesLT.SalesOrderHeader\"}, {\"SalesLT.CustomerAddress.SalesLT.Customer.CustomerID\", \"SalesLT.CustomerAddress.SalesLT.Customer.NameStyle\", \"SalesLT.CustomerAddress.SalesLT.Customer.Title\", \"SalesLT.CustomerAddress.SalesLT.Customer.FirstName\", \"SalesLT.CustomerAddress.SalesLT.Customer.MiddleName\", \"SalesLT.CustomerAddress.SalesLT.Customer.LastName\", \"SalesLT.CustomerAddress.SalesLT.Customer.Suffix\", \"SalesLT.CustomerAddress.SalesLT.Customer.CompanyName\", \"SalesLT.CustomerAddress.SalesLT.Customer.SalesPerson\", \"SalesLT.CustomerAddress.SalesLT.Customer.EmailAddress\", \"SalesLT.CustomerAddress.SalesLT.Customer.Phone\", \"SalesLT.CustomerAddress.SalesLT.Customer.PasswordHash\", \"SalesLT.CustomerAddress.SalesLT.Customer.PasswordSalt\", \"SalesLT.CustomerAddress.SalesLT.Customer.rowguid\", \"SalesLT.CustomerAddress.SalesLT.Customer.ModifiedDate\", \"SalesLT.CustomerAddress.SalesLT.Customer.SalesLT.CustomerAddress\", \"SalesLT.CustomerAddress.SalesLT.Customer.SalesLT.SalesOrderHeader\"}),\r\n  #\"Expanded saleordHdr\" = Table.ExpandTableColumn(#\"Expanded SalesLT.CustomerAddress.SalesLT.Customer\", \"saleordHdr\", {\"SalesOrderID\", \"RevisionNumber\", \"OrderDate\", \"DueDate\", \"ShipDate\", \"Status\", \"OnlineOrderFlag\", \"SalesOrderNumber\", \"PurchaseOrderNumber\", \"AccountNumber\", \"CustomerID\", \"ShipToAddressID\", \"BillToAddressID\", \"ShipMethod\", \"CreditCardApprovalCode\", \"SubTotal\", \"TaxAmt\", \"Freight\", \"TotalDue\", \"Comment\", \"rowguid\", \"ModifiedDate\", \"SalesLT.Address(BillToAddressID)\", \"SalesLT.Address(ShipToAddressID)\", \"SalesLT.Customer\", \"SalesLT.SalesOrderDetail\"}, {\"saleordHdr.SalesOrderID\", \"saleordHdr.RevisionNumber\", \"saleordHdr.OrderDate\", \"saleordHdr.DueDate\", \"saleordHdr.ShipDate\", \"saleordHdr.Status\", \"saleordHdr.OnlineOrderFlag\", \"saleordHdr.SalesOrderNumber\", \"saleordHdr.PurchaseOrderNumber\", \"saleordHdr.AccountNumber\", \"saleordHdr.CustomerID\", \"saleordHdr.ShipToAddressID\", \"saleordHdr.BillToAddressID\", \"saleordHdr.ShipMethod\", \"saleordHdr.CreditCardApprovalCode\", \"saleordHdr.SubTotal\", \"saleordHdr.TaxAmt\", \"saleordHdr.Freight\", \"saleordHdr.TotalDue\", \"saleordHdr.Comment\", \"saleordHdr.rowguid\", \"saleordHdr.ModifiedDate\", \"saleordHdr.SalesLT.Address(BillToAddressID)\", \"saleordHdr.SalesLT.Address(ShipToAddressID)\", \"saleordHdr.SalesLT.Customer\", \"saleordHdr.SalesLT.SalesOrderDetail\"}),\r\n  #\"Expanded saleordHdr.SalesLT.SalesOrderDetail\" = Table.ExpandTableColumn(#\"Expanded saleordHdr\", \"saleordHdr.SalesLT.SalesOrderDetail\", {\"SalesOrderID\", \"SalesOrderDetailID\", \"OrderQty\", \"ProductID\", \"UnitPrice\", \"UnitPriceDiscount\", \"LineTotal\", \"rowguid\", \"ModifiedDate\", \"SalesLT.Product\", \"SalesLT.SalesOrderHeader\"}, {\"saleordHdr.SalesLT.SalesOrderDetail.SalesOrderID\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesOrderDetailID\", \"saleordHdr.SalesLT.SalesOrderDetail.OrderQty\", \"saleordHdr.SalesLT.SalesOrderDetail.ProductID\", \"saleordHdr.SalesLT.SalesOrderDetail.UnitPrice\", \"saleordHdr.SalesLT.SalesOrderDetail.UnitPriceDiscount\", \"saleordHdr.SalesLT.SalesOrderDetail.LineTotal\", \"saleordHdr.SalesLT.SalesOrderDetail.rowguid\", \"saleordHdr.SalesLT.SalesOrderDetail.ModifiedDate\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.Product\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader\"}),\r\n  #\"Expanded saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader\" = Table.ExpandRecordColumn(#\"Expanded saleordHdr.SalesLT.SalesOrderDetail\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader\", {\"SalesOrderID\", \"RevisionNumber\", \"OrderDate\", \"DueDate\", \"ShipDate\", \"Status\", \"OnlineOrderFlag\", \"SalesOrderNumber\", \"PurchaseOrderNumber\", \"AccountNumber\", \"CustomerID\", \"ShipToAddressID\", \"BillToAddressID\", \"ShipMethod\", \"CreditCardApprovalCode\", \"SubTotal\", \"TaxAmt\", \"Freight\", \"TotalDue\", \"Comment\", \"rowguid\", \"ModifiedDate\", \"SalesLT.Address(BillToAddressID)\", \"SalesLT.Address(ShipToAddressID)\", \"SalesLT.Customer\", \"SalesLT.SalesOrderDetail\"}, {\"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesOrderID\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.RevisionNumber\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.OrderDate\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.DueDate\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.ShipDate\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.Status\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.OnlineOrderFlag\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesOrderNumber\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.PurchaseOrderNumber\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.AccountNumber\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.CustomerID\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.ShipToAddressID\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.BillToAddressID\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.ShipMethod\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.CreditCardApprovalC\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SubTotal\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.TaxAmt\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.Freight\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.TotalDue\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.Comment\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.rowguid\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.ModifiedDate\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Address(Bil\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Address(Shi\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.SalesOrderD\"}),\r\n  #\"Expanded saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer\" = Table.ExpandRecordColumn(#\"Expanded saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer\", {\"CustomerID\", \"NameStyle\", \"Title\", \"FirstName\", \"MiddleName\", \"LastName\", \"Suffix\", \"CompanyName\", \"SalesPerson\", \"EmailAddress\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"rowguid\", \"ModifiedDate\", \"SalesLT.CustomerAddress\", \"SalesLT.SalesOrderHeader\"}, {\"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Cu\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Na\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Ti\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Fi\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Mi\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.La\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Su\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Co\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Sa\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Em\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Ph\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Pa\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer..1\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.ro\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer.Mo\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer..2\", \"saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer..3\"}),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Expanded saleordHdr.SalesLT.SalesOrderDetail.SalesLT.SalesOrderHeader.SalesLT.Customer\", {\"Suffix\", \"saleordHdr.SalesLT.Address(BillToAddressID)\"})\r\nin\r\n  #\"Removed columns\";\r\n"
		}
	}
}